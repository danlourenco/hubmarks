import{a as R,r as v,j as e,u as F,d as H,S as P,b as G,R as $,c as L}from"./SyncStatus-DvvZqaf4.js";function B({limit:n=50,showSearch:u=!0,onBookmarkClick:d,className:b=""}){const{bookmarks:i,isLoading:j,error:x,searchQuery:m,selectedFolder:p,folderPaths:c,bookmarkCount:g,totalBookmarks:o,isFiltered:a,setSearchQuery:f,setSelectedFolder:h,clearSearch:r,deleteBookmark:l}=R(),[C,y]=v.useState(null),N=i.slice(0,n),k=(s,t)=>{s.preventDefault(),s.stopPropagation(),y(t)},S=async s=>{await l(s)&&y(null)},D=()=>{y(null)},w=s=>{try{return`https://www.google.com/s2/favicons?sz=16&domain=${new URL(s).hostname}`}catch{return null}};return j?e.jsx("div",{className:`bookmark-list ${b}`,children:e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin text-2xl",children:"⟳"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading bookmarks..."})]})}):e.jsxs("div",{className:`bookmark-list ${b}`,children:[u&&e.jsxs("div",{className:"search-controls mb-4 space-y-2",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",placeholder:"Search bookmarks...",value:m,onChange:s=>f(s.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),a&&e.jsx("button",{onClick:r,className:"px-3 py-2 text-sm text-gray-600 hover:text-gray-800",title:"Clear search",children:"✕"})]}),c.length>0&&e.jsxs("select",{value:p,onChange:s=>h(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All folders"}),c.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),x&&e.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded mb-4",children:x}),e.jsx("div",{className:"bookmark-count text-sm text-gray-600 mb-3",children:a?e.jsxs(e.Fragment,{children:["Showing ",g," of ",o," bookmarks",g>n&&` (first ${n})`]}):e.jsxs(e.Fragment,{children:[o," bookmarks",o>n&&` (showing first ${n})`]})}),N.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:a?"No bookmarks match your search":"No bookmarks found"}):e.jsx("div",{className:"bookmark-items space-y-2",children:N.map(s=>e.jsxs("div",{className:"bookmark-item border border-gray-200 rounded p-3 hover:bg-gray-50 cursor-pointer group",onClick:()=>d==null?void 0:d(s),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[w(s.url)&&e.jsx("img",{src:w(s.url),alt:"",className:"w-4 h-4 flex-shrink-0",onError:t=>t.currentTarget.style.display="none"}),e.jsx("h4",{className:"font-medium text-gray-900 truncate",children:s.title})]}),e.jsx("div",{className:"text-sm text-blue-600 truncate mb-1",children:s.url}),s.folderPath&&e.jsxs("div",{className:"text-xs text-gray-500 mb-1",children:["📁 ",s.folderPath]}),s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-1",children:s.tags.map(t=>e.jsxs("span",{className:"inline-block px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:["#",t]},t))}),s.notes&&e.jsx("div",{className:"text-sm text-gray-600 italic",children:s.notes})]}),e.jsxs("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),window.open(s.url,"_blank")},className:"p-1 text-gray-400 hover:text-blue-600",title:"Open bookmark",children:"🔗"}),e.jsx("button",{onClick:t=>k(t,s.id),className:"p-1 text-gray-400 hover:text-red-600",title:"Delete bookmark",children:"🗑"})]})]}),C===s.id&&e.jsxs("div",{className:"mt-3 p-2 bg-red-50 border border-red-200 rounded",children:[e.jsx("div",{className:"text-sm text-red-800 mb-2",children:"Delete this bookmark?"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>S(s.id),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700",children:"Delete"}),e.jsx("button",{onClick:D,className:"px-3 py-1 bg-gray-300 text-gray-700 text-sm rounded hover:bg-gray-400",children:"Cancel"})]})]})]},s.id))})]})}function E({className:n="",showDirectionOptions:u=!1}){const{triggerSync:d,resolveConflicts:b,isLoading:i,error:j,hasConflicts:x,isSyncing:m}=F(),{isConfigured:p}=H(),[c,g]=v.useState("bidirectional"),[o,a]=v.useState(!1),f=async()=>{var l;console.log("🔘 [SyncControls] Sync button clicked, direction:",c);const r=await d(c);console.log("🔘 [SyncControls] Sync result:",r),((l=r==null?void 0:r.conflicts)==null?void 0:l.length)>0&&a(!0)},h=async r=>{const l=await b(r);l!=null&&l.success&&a(!1)};return p?e.jsxs("div",{className:`sync-controls ${n}`,children:[u&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sync Direction"}),e.jsxs("select",{value:c,onChange:r=>g(r.target.value),className:"select select-bordered select-sm w-full",disabled:m,children:[e.jsx("option",{value:"bidirectional",children:"⟷ Two-way sync"}),e.jsx("option",{value:"to-github",children:"→ Browser to GitHub"}),e.jsx("option",{value:"from-github",children:"← GitHub to Browser"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:f,disabled:m||i,className:"btn btn-primary flex-1",children:m?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin mr-2",children:"⟳"}),"Syncing..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:"🔄"}),"Sync Now"]})}),x&&e.jsx("button",{onClick:()=>a(!o),className:"btn btn-warning",title:"Resolve conflicts",children:"⚡"})]}),j&&e.jsx("div",{className:"alert alert-error mt-3",children:e.jsx("span",{children:j})}),o&&x&&e.jsx("div",{className:"card bg-warning/10 border-warning mt-4",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h4",{className:"card-title text-warning",children:"Resolve Conflicts"}),e.jsx("p",{className:"text-sm mb-4",children:"Conflicts were detected during sync. Choose how to resolve them:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>h("latest-wins"),disabled:i,className:"btn btn-outline btn-warning w-full text-left justify-start p-3 h-auto",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Keep Latest Changes"}),e.jsx("div",{className:"text-sm opacity-70",children:"Prefer the most recently modified bookmarks"})]})}),e.jsx("button",{onClick:()=>h("browser-wins"),disabled:i,className:"btn btn-outline btn-warning w-full text-left justify-start p-3 h-auto",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Keep Browser Version"}),e.jsx("div",{className:"text-sm opacity-70",children:"Prefer bookmarks from this browser"})]})}),e.jsx("button",{onClick:()=>h("github-wins"),disabled:i,className:"btn btn-outline btn-warning w-full text-left justify-start p-3 h-auto",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Keep GitHub Version"}),e.jsx("div",{className:"text-sm opacity-70",children:"Prefer bookmarks from GitHub repository"})]})})]}),e.jsx("div",{className:"card-actions justify-end",children:e.jsx("button",{onClick:()=>a(!1),className:"btn btn-sm btn-ghost",children:"Cancel"})})]})}),u&&e.jsx("div",{className:"mt-3 text-xs text-gray-500",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Two-way:"})," Merge changes from both sources"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"To GitHub:"})," Upload browser bookmarks to repository"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"From GitHub:"})," Download repository bookmarks to browser"]})]})})]}):e.jsx("div",{className:`sync-controls ${n}`,children:e.jsx("div",{className:"alert alert-warning",children:e.jsx("span",{children:"GitHub not configured"})})})}function M(){const n=()=>{G.runtime.openOptionsPage()};return e.jsxs("div",{className:"w-80 min-h-96 bg-base-100",children:[e.jsxs("header",{className:"flex items-center justify-between p-4 border-b border-base-200 bg-base-200",children:[e.jsx("h1",{className:"text-xl font-bold text-primary",children:"HubMark"}),e.jsx("button",{onClick:n,className:"btn btn-primary btn-sm",children:"Settings"})]}),e.jsxs("main",{className:"p-4 space-y-4",children:[e.jsx(P,{}),e.jsx(E,{}),e.jsx(B,{})]})]})}$.createRoot(document.getElementById("root")).render(e.jsx(L.StrictMode,{children:e.jsx(M,{})}));
